Note: Raw evidence is stored locally under `_local_evidence/` and is not committed.
References here are pointers only.

# Evidence Index

| Evidence ID                   | Type (HAR/SQL/Shot) | Persona | Scenario                                                   | File path                                                                                      | Notes                                                                                                                                                                       |
| ----------------------------- | ------------------- | ------- | ---------------------------------------------------------- | ---------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| AR-ANON-ROUTE-DENY-HAR        | HAR                 | Anon    | Visit `/admin/reports` and confirm redirect to `/auth`     | `docs/version5/hardening/surfaces/admin-reports/evidence/har/AR-ANON-ROUTE-DENY.har`           | Capture 302/redirect chain + toast.                                                                                                                                         |
| AR-ANON-ROUTE-DENY-SHOT       | Shot                | Anon    | Auth redirect screen                                       | `docs/version5/hardening/surfaces/admin-reports/evidence/screenshots/AR-ANON-ROUTE-DENY.png`   | Include URL bar + toast.                                                                                                                                                    |
| AR-NONADMIN-DENY-HAR          | HAR                 | Normal  | Authenticated non-admin blocked from reports               | `docs/version5/hardening/surfaces/admin-reports/evidence/har/AR-NONADMIN-DENY.har`             | Expect redirect to `/feed` + toast.                                                                                                                                         |
| AR-NONADMIN-DENY-SHOT         | Shot                | Normal  | Post-redirect screen + toast                               | `docs/version5/hardening/surfaces/admin-reports/evidence/screenshots/AR-NONADMIN-DENY.png`     | Capture toast text.                                                                                                                                                         |
| AR-OWNER-DENY-HAR             | HAR                 | Owner   | Owner blocked from reports                                 | `docs/version5/hardening/surfaces/admin-reports/evidence/har/AR-OWNER-DENY.har`                | Expect redirect to `/feed`.                                                                                                                                                 |
| AR-OWNER-DENY-SHOT            | Shot                | Owner   | Post-redirect screen + toast                               | `docs/version5/hardening/surfaces/admin-reports/evidence/screenshots/AR-OWNER-DENY.png`        | Capture toast text.                                                                                                                                                         |
| AR-PRIVATE-DENY-HAR           | HAR                 | Private | Private (authenticated, non-owner) denied from reports     | `docs/version5/hardening/surfaces/admin-reports/evidence/har/AR-PRIVATE-DENY.har`              | Expect redirect to `/feed` + toast.                                                                                                                                         |
| AR-PRIVATE-DENY-SHOT          | Shot                | Private | Post-redirect screen + toast                               | `docs/version5/hardening/surfaces/admin-reports/evidence/screenshots/AR-PRIVATE-DENY.png`      | Capture toast text.                                                                                                                                                         |
| AR-BLOCKED-DENY-HAR           | HAR                 | Blocked | Blocked persona (authenticated) denied from reports        | `docs/version5/hardening/surfaces/admin-reports/evidence/har/AR-BLOCKED-DENY.har`              | Expect redirect to `/feed` + toast.                                                                                                                                         |
| AR-BLOCKED-DENY-SHOT          | Shot                | Blocked | Post-redirect screen + toast                               | `docs/version5/hardening/surfaces/admin-reports/evidence/screenshots/AR-BLOCKED-DENY.png`      | Capture toast text.                                                                                                                                                         |
| AR-ADMIN-ALLOW-HAR            | HAR                 | Admin   | Admin loads reports list                                   | `docs/version5/hardening/surfaces/admin-reports/evidence/har/AR-ADMIN-ALLOW.har`               | Should include `admin_list_reports` + realtime subscribe.                                                                                                                   |
| AR-ADMIN-ALLOW-SHOT           | Shot                | Admin   | Reports table loaded                                       | `docs/version5/hardening/surfaces/admin-reports/evidence/screenshots/AR-ADMIN-ALLOW.png`       | Show filters + list.                                                                                                                                                        |
| AR-RPC-NONADMIN-DENY-HAR      | HAR                 | Normal  | Call `admin_list_reports` as non-admin                     | `docs/version5/hardening/surfaces/admin-reports/evidence/har/AR-RPC-NONADMIN-DENY.har`         | Expect error "Admin privileges required".                                                                                                                                   |
| AR-RPC-NONADMIN-DENY-SHOT     | Shot                | Normal  | RPC error surfaced in UI/console                           | `docs/version5/hardening/surfaces/admin-reports/evidence/screenshots/AR-RPC-NONADMIN-DENY.png` | Capture error text.                                                                                                                                                         |
| AR-SQL-GRANTS                 | SQL                 | Admin   | Grants on touched tables                                   | `docs/version5/hardening/surfaces/admin-reports/evidence/sql/AR-GRANTS.sql`                    | `admin_users, reports, profiles, catches, catch_comments, user_warnings, moderation_log`.                                                                                   |
| AR-SQL-RLS-POLICIES           | SQL                 | Admin   | RLS policies for touched tables                            | `docs/version5/hardening/surfaces/admin-reports/evidence/sql/AR-RLS-POLICIES.sql`              | Include `reports_admin_all`, `catches_admin_read_all`, `catch_comments_admin_read_all`, `user_warnings_admin_read`, `moderation_log_admin_read`, `admin_users_self_select`. |
| AR-SQL-RPC-GRANTS             | SQL                 | Admin   | EXECUTE grants + definitions for admin RPCs                | `docs/version5/hardening/surfaces/admin-reports/evidence/sql/AR-RPC-GRANTS.sql`                | Include `admin_list_reports`, `admin_update_report_status`, `admin_delete_*`, `admin_restore_*`, `admin_warn_user`.                                                         |
| AR-SQL-REALTIME-PUBLICATION   | SQL                 | Admin   | Check `supabase_realtime` publication for `public.reports` | `docs/version5/hardening/surfaces/admin-reports/evidence/sql/AR-REALTIME-PUBLICATION.sql`      | Confirms whether Postgres Changes can stream.                                                                                                                               |
| AR-SQL-NONADMIN-DIRECT-SELECT | SQL                 | Normal  | Direct SELECT on `reports` as non-admin                    | `docs/version5/hardening/surfaces/admin-reports/evidence/sql/AR-NONADMIN-REPORTS-SELECT.sql`   | Expect 0 rows or RLS error.                                                                                                                                                 |
