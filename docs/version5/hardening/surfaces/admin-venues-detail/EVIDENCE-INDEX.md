# Evidence Index

| Evidence ID                                        | Type (HAR/SQL/Shot) | Persona | Scenario                                                                                                                              | File path                                                                                                                     | Notes                                                                                                                                                                                                                                                                                                                                                                                                                          |
| -------------------------------------------------- | ------------------- | ------- | ------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| AVD-ANON-ROUTE-DENY-HAR                            | HAR                 | Anon    | Visit `/admin/venues/:slug` and confirm redirect to `/auth`                                                                           | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-ANON-ROUTE-DENY.har`                                   | Capture redirect chain.                                                                                                                                                                                                                                                                                                                                                                                                        |
| AVD-ANON-ROUTE-DENY-SHOT                           | Shot                | Anon    | Auth redirect screen                                                                                                                  | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-ANON-ROUTE-DENY.png`                           | Include URL bar.                                                                                                                                                                                                                                                                                                                                                                                                               |
| AVD-NORMAL-DENY-HAR                                | HAR                 | Normal  | Authenticated non-admin blocked from admin venue detail                                                                               | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-NORMAL-DENY.har`                                       | Expect toast "You must be an admin to view this page." + navigate to `/`.                                                                                                                                                                                                                                                                                                                                                      |
| AVD-NORMAL-DENY-SHOT                               | Shot                | Normal  | Post-redirect screen + toast                                                                                                          | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-NORMAL-DENY.png`                               | Capture toast text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-OWNER-DENY-HAR                                 | HAR                 | Owner   | Owner blocked from admin venue detail                                                                                                 | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-OWNER-DENY.har`                                        | Expect toast + navigate to `/`.                                                                                                                                                                                                                                                                                                                                                                                                |
| AVD-OWNER-DENY-SHOT                                | Shot                | Owner   | Post-redirect screen + toast                                                                                                          | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-OWNER-DENY.png`                                | Capture toast text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-PRIVATE-DENY-HAR                               | HAR                 | Private | Private persona blocked from admin venue detail                                                                                       | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-PRIVATE-DENY.har`                                      | Expect toast + navigate to `/`.                                                                                                                                                                                                                                                                                                                                                                                                |
| AVD-PRIVATE-DENY-SHOT                              | Shot                | Private | Post-redirect screen + toast                                                                                                          | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-PRIVATE-DENY.png`                              | Capture toast text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-BLOCKED-DENY-HAR                               | HAR                 | Blocked | Blocked persona blocked from admin venue detail                                                                                       | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-BLOCKED-DENY.har`                                      | Expect toast + navigate to `/`.                                                                                                                                                                                                                                                                                                                                                                                                |
| AVD-BLOCKED-DENY-SHOT                              | Shot                | Blocked | Post-redirect screen + toast                                                                                                          | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-BLOCKED-DENY.png`                              | Capture toast text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-ADMIN-ALLOW-HAR                                | HAR                 | Admin   | Admin loads venue detail and all sections                                                                                             | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-ADMIN-ALLOW.har`                                       | Should include `admin_get_venue_by_slug`, `admin_get_venue_events`, `get_venue_photos`, `venue_owners` select, and section reads. Confirm there are **no direct PostgREST writes** (only reads) and that mutations go via admin RPCs.                                                                                                                                                                                          |
| AVD-ADMIN-ALLOW-SHOT                               | Shot                | Admin   | Venue detail page loaded                                                                                                              | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-ADMIN-ALLOW.png`                               | Capture header + at least one section.                                                                                                                                                                                                                                                                                                                                                                                         |
| AVD-ADMIN-CRUD-SESSION-HAR                         | HAR                 | Admin   | Single session covering all admin mutations (metadata, booking, owners, events, rules, opening hours, pricing, species stock, photos) | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-ADMIN-CRUD-SESSION.har`                                | Belt-and-braces: prove shared components do not perform direct PostgREST writes; mutations should be RPC-only (+ storage for photos).                                                                                                                                                                                                                                                                                          |
| AVD-ADMIN-CRUD-SESSION-SHOT                        | Shot                | Admin   | End-of-session state after multiple saves                                                                                             | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-ADMIN-CRUD-SESSION.png`                        | Optional: show several sections updated + any success toasts.                                                                                                                                                                                                                                                                                                                                                                  |
| AVD-ADMIN-SAVE-METADATA-HAR                        | HAR                 | Admin   | Edit metadata fields and click Save (calls `admin_update_venue_metadata`)                                                             | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-ADMIN-SAVE-METADATA.har`                               | Capture RPC request/response + subsequent refresh via `admin_get_venue_by_slug`.                                                                                                                                                                                                                                                                                                                                               |
| AVD-ADMIN-SAVE-METADATA-SHOT                       | Shot                | Admin   | Metadata saved state                                                                                                                  | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-ADMIN-SAVE-METADATA.png`                       | Show saved fields + success toast.                                                                                                                                                                                                                                                                                                                                                                                             |
| AVD-ADMIN-TOGGLE-BOOKING-HAR                       | HAR                 | Admin   | Toggle booking enabled (calls `admin_update_venue_booking`)                                                                           | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-ADMIN-TOGGLE-BOOKING.har`                              | Capture RPC request/response.                                                                                                                                                                                                                                                                                                                                                                                                  |
| AVD-ADMIN-TOGGLE-BOOKING-SHOT                      | Shot                | Admin   | Booking toggle updated                                                                                                                | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-ADMIN-TOGGLE-BOOKING.png`                      | Show toggle + toast/state.                                                                                                                                                                                                                                                                                                                                                                                                     |
| AVD-ADMIN-OWNERS-ADDREMOVE-HAR                     | HAR                 | Admin   | Add and then remove a venue owner (calls `admin_add_venue_owner` + `admin_remove_venue_owner`)                                        | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-ADMIN-OWNERS-ADDREMOVE.har`                            | Capture both RPC calls + owners refresh (`venue_owners` select).                                                                                                                                                                                                                                                                                                                                                               |
| AVD-ADMIN-OWNERS-ADDREMOVE-SHOT                    | Shot                | Admin   | Owners list after add/remove                                                                                                          | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-ADMIN-OWNERS-ADDREMOVE.png`                    | Show owners section + updated list.                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-ADMIN-EVENTS-CRUD-HAR                          | HAR                 | Admin   | Create and delete an event (calls `admin_create_venue_event` + `admin_delete_venue_event`)                                            | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-ADMIN-EVENTS-CRUD.har`                                 | Capture create/delete RPCs + refresh via `admin_get_venue_events`.                                                                                                                                                                                                                                                                                                                                                             |
| AVD-ADMIN-EVENTS-CRUD-SHOT                         | Shot                | Admin   | Events section after create/delete                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-ADMIN-EVENTS-CRUD.png`                         | Show event row appears/disappears + any toast.                                                                                                                                                                                                                                                                                                                                                                                 |
| AVD-ADMIN-RULES-SAVE-HAR                           | HAR                 | Admin   | Edit venue rules and save (calls `admin_update_venue_rules`)                                                                          | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-ADMIN-RULES-SAVE.har`                                  | Capture RPC + confirm rules text persisted (subsequent `venue_rules` select).                                                                                                                                                                                                                                                                                                                                                  |
| AVD-ADMIN-RULES-SAVE-SHOT                          | Shot                | Admin   | Rules saved state                                                                                                                     | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-ADMIN-RULES-SAVE.png`                          | Show rules text + toast/state.                                                                                                                                                                                                                                                                                                                                                                                                 |
| AVD-ADMIN-OPENING-HOURS-CRUD-HAR                   | HAR                 | Admin   | Add/update/delete an opening hour (calls `admin_create/update/delete_venue_opening_hour`)                                             | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-ADMIN-OPENING-HOURS-CRUD.har`                          | Capture at least one of each operation + refresh of `venue_opening_hours` select.                                                                                                                                                                                                                                                                                                                                              |
| AVD-ADMIN-OPENING-HOURS-CRUD-SHOT                  | Shot                | Admin   | Opening hours updated                                                                                                                 | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-ADMIN-OPENING-HOURS-CRUD.png`                  | Show list/table state after operations.                                                                                                                                                                                                                                                                                                                                                                                        |
| AVD-ADMIN-PRICING-CRUD-HAR                         | HAR                 | Admin   | Add/update/delete a pricing tier (calls `admin_create/update/delete_venue_pricing_tier`)                                              | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-ADMIN-PRICING-CRUD.har`                                | Capture at least one of each operation + refresh of `venue_pricing_tiers` select.                                                                                                                                                                                                                                                                                                                                              |
| AVD-ADMIN-PRICING-CRUD-SHOT                        | Shot                | Admin   | Pricing tiers updated                                                                                                                 | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-ADMIN-PRICING-CRUD.png`                        | Show list state after operations.                                                                                                                                                                                                                                                                                                                                                                                              |
| AVD-ADMIN-SPECIES-STOCK-CRUD-HAR                   | HAR                 | Admin   | Add/update/delete a species stock row (calls `admin_create/update/delete_venue_species_stock`)                                        | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-ADMIN-SPECIES-STOCK-CRUD.har`                          | Capture at least one of each operation + refresh of `venue_species_stock` select.                                                                                                                                                                                                                                                                                                                                              |
| AVD-ADMIN-SPECIES-STOCK-CRUD-SHOT                  | Shot                | Admin   | Species stock updated                                                                                                                 | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-ADMIN-SPECIES-STOCK-CRUD.png`                  | Show list state after operations.                                                                                                                                                                                                                                                                                                                                                                                              |
| AVD-ADMIN-PHOTO-PRIMARY-HAR                        | HAR                 | Admin   | Set a photo as primary (calls `admin_set_venue_photo_primary`)                                                                        | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-ADMIN-PHOTO-PRIMARY.har`                               | Capture RPC request/response + any subsequent refresh (`get_venue_photos`).                                                                                                                                                                                                                                                                                                                                                    |
| AVD-ADMIN-PHOTO-PRIMARY-SHOT                       | Shot                | Admin   | Primary photo reflected in UI                                                                                                         | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-ADMIN-PHOTO-PRIMARY.png`                       | Show primary badge/state.                                                                                                                                                                                                                                                                                                                                                                                                      |
| AVD-ADMIN-PHOTO-DELETE-HAR                         | HAR                 | Admin   | Delete a venue photo (storage remove + `admin_delete_venue_photo`)                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-ADMIN-PHOTO-DELETE.har`                                | Capture storage delete + RPC + list refresh.                                                                                                                                                                                                                                                                                                                                                                                   |
| AVD-ADMIN-PHOTO-DELETE-SHOT                        | Shot                | Admin   | Photo removed state                                                                                                                   | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-ADMIN-PHOTO-DELETE.png`                        | Show photo removed + any toast.                                                                                                                                                                                                                                                                                                                                                                                                |
| AVD-ADMIN-PHOTO-UPLOAD-HAR                         | HAR                 | Admin   | Upload a venue photo (storage + `admin_add_venue_photo`)                                                                              | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-ADMIN-PHOTO-UPLOAD.har`                                | Capture storage upload path + RPC body.                                                                                                                                                                                                                                                                                                                                                                                        |
| AVD-ADMIN-PHOTO-UPLOAD-SHOT                        | Shot                | Admin   | Photo upload success state                                                                                                            | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-ADMIN-PHOTO-UPLOAD.png`                        | Show uploaded photo and any toast.                                                                                                                                                                                                                                                                                                                                                                                             |
| AVD-POSTGREST-NONADMIN-DENY-HAR                    | HAR                 | Normal  | Direct PostgREST reads of underlying tables/views                                                                                     | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-POSTGREST-NONADMIN-DENY.har`                           | Attempt as non-admin: `GET /rest/v1/admin_users?select=*`, `venue_owners`, `profiles`, `venue_rules`, `venue_opening_hours`, `venue_pricing_tiers`, `venue_species_stock`, `venue_events`, `venue_photos`, `venues`, `venue_stats`. Expect deny or 0 rows. Also probe `GET /rest/v1/venues?select=id,slug,name,notes_for_rr_team` (ensure internal notes are not returned) and `GET /rest/v1/venue_stats?select=*` if exposed. |
| AVD-POSTGREST-NONADMIN-DENY-SHOT                   | Shot                | Normal  | PostgREST error/response captured                                                                                                     | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-POSTGREST-NONADMIN-DENY.png`                   | Capture response payload + status for each endpoint.                                                                                                                                                                                                                                                                                                                                                                           |
| AVD-POSTGREST-NONADMIN-WRITE-DENY-HAR              | HAR                 | Normal  | Attempt direct PostgREST writes to venue tables (non-owner)                                                                           | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-POSTGREST-NONADMIN-WRITE-DENY.har`                     | Attempt as non-admin: `POST/PATCH/DELETE` against `venue_rules`, `venue_opening_hours`, `venue_pricing_tiers`, `venue_species_stock`, `venue_photos`, `venue_events`, `venue_owners`, `venues`. Expect 401/403 or RLS deny. NOTE: owner-allowed writes are tested on `/my-venues/:slug` surface, not here.                                                                                                                     |
| AVD-POSTGREST-NONADMIN-WRITE-DENY-SHOT             | Shot                | Normal  | PostgREST write denial captured                                                                                                       | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-POSTGREST-NONADMIN-WRITE-DENY.png`             | Capture status + response body for at least 2 representative write attempts.                                                                                                                                                                                                                                                                                                                                                   |
| AVD-RPC-NONADMIN-DENY-GET-VENUE-BY-SLUG-HAR        | HAR                 | Normal  | Call `admin_get_venue_by_slug` as non-admin                                                                                           | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-GET-VENUE-BY-SLUG.har`               | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-GET-VENUE-BY-SLUG-SHOT       | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-GET-VENUE-BY-SLUG.png`       | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-GET-VENUE-EVENTS-HAR         | HAR                 | Normal  | Call `admin_get_venue_events` as non-admin                                                                                            | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-GET-VENUE-EVENTS.har`                | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-GET-VENUE-EVENTS-SHOT        | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-GET-VENUE-EVENTS.png`        | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-UPDATE-VENUE-METADATA-HAR    | HAR                 | Normal  | Call `admin_update_venue_metadata` as non-admin                                                                                       | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-UPDATE-VENUE-METADATA.har`           | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-UPDATE-VENUE-METADATA-SHOT   | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-UPDATE-VENUE-METADATA.png`   | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-ADD-VENUE-OWNER-HAR          | HAR                 | Normal  | Call `admin_add_venue_owner` as non-admin                                                                                             | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-ADD-VENUE-OWNER.har`                 | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-ADD-VENUE-OWNER-SHOT         | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-ADD-VENUE-OWNER.png`         | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-REMOVE-VENUE-OWNER-HAR       | HAR                 | Normal  | Call `admin_remove_venue_owner` as non-admin                                                                                          | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-REMOVE-VENUE-OWNER.har`              | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-REMOVE-VENUE-OWNER-SHOT      | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-REMOVE-VENUE-OWNER.png`      | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-CREATE-VENUE-EVENT-HAR       | HAR                 | Normal  | Call `admin_create_venue_event` as non-admin                                                                                          | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-CREATE-VENUE-EVENT.har`              | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-CREATE-VENUE-EVENT-SHOT      | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-CREATE-VENUE-EVENT.png`      | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-UPDATE-VENUE-EVENT-HAR       | HAR                 | Normal  | Call `admin_update_venue_event` as non-admin                                                                                          | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-UPDATE-VENUE-EVENT.har`              | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-UPDATE-VENUE-EVENT-SHOT      | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-UPDATE-VENUE-EVENT.png`      | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-DELETE-VENUE-EVENT-HAR       | HAR                 | Normal  | Call `admin_delete_venue_event` as non-admin                                                                                          | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-DELETE-VENUE-EVENT.har`              | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-DELETE-VENUE-EVENT-SHOT      | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-DELETE-VENUE-EVENT.png`      | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-UPDATE-VENUE-BOOKING-HAR     | HAR                 | Normal  | Call `admin_update_venue_booking` as non-admin                                                                                        | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-UPDATE-VENUE-BOOKING.har`            | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-UPDATE-VENUE-BOOKING-SHOT    | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-UPDATE-VENUE-BOOKING.png`    | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-UPDATE-VENUE-RULES-HAR       | HAR                 | Normal  | Call `admin_update_venue_rules` as non-admin                                                                                          | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-UPDATE-VENUE-RULES.har`              | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-UPDATE-VENUE-RULES-SHOT      | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-UPDATE-VENUE-RULES.png`      | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-CREATE-OPENING-HOUR-HAR      | HAR                 | Normal  | Call `admin_create_venue_opening_hour` as non-admin                                                                                   | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-CREATE-OPENING-HOUR.har`             | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-CREATE-OPENING-HOUR-SHOT     | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-CREATE-OPENING-HOUR.png`     | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-UPDATE-OPENING-HOUR-HAR      | HAR                 | Normal  | Call `admin_update_venue_opening_hour` as non-admin                                                                                   | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-UPDATE-OPENING-HOUR.har`             | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-UPDATE-OPENING-HOUR-SHOT     | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-UPDATE-OPENING-HOUR.png`     | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-DELETE-OPENING-HOUR-HAR      | HAR                 | Normal  | Call `admin_delete_venue_opening_hour` as non-admin                                                                                   | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-DELETE-OPENING-HOUR.har`             | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-DELETE-OPENING-HOUR-SHOT     | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-DELETE-OPENING-HOUR.png`     | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-CREATE-PRICING-TIER-HAR      | HAR                 | Normal  | Call `admin_create_venue_pricing_tier` as non-admin                                                                                   | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-CREATE-PRICING-TIER.har`             | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-CREATE-PRICING-TIER-SHOT     | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-CREATE-PRICING-TIER.png`     | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-UPDATE-PRICING-TIER-HAR      | HAR                 | Normal  | Call `admin_update_venue_pricing_tier` as non-admin                                                                                   | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-UPDATE-PRICING-TIER.har`             | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-UPDATE-PRICING-TIER-SHOT     | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-UPDATE-PRICING-TIER.png`     | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-DELETE-PRICING-TIER-HAR      | HAR                 | Normal  | Call `admin_delete_venue_pricing_tier` as non-admin                                                                                   | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-DELETE-PRICING-TIER.har`             | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-DELETE-PRICING-TIER-SHOT     | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-DELETE-PRICING-TIER.png`     | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-CREATE-SPECIES-STOCK-HAR     | HAR                 | Normal  | Call `admin_create_venue_species_stock` as non-admin                                                                                  | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-CREATE-SPECIES-STOCK.har`            | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-CREATE-SPECIES-STOCK-SHOT    | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-CREATE-SPECIES-STOCK.png`    | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-UPDATE-SPECIES-STOCK-HAR     | HAR                 | Normal  | Call `admin_update_venue_species_stock` as non-admin                                                                                  | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-UPDATE-SPECIES-STOCK.har`            | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-UPDATE-SPECIES-STOCK-SHOT    | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-UPDATE-SPECIES-STOCK.png`    | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-DELETE-SPECIES-STOCK-HAR     | HAR                 | Normal  | Call `admin_delete_venue_species_stock` as non-admin                                                                                  | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-DELETE-SPECIES-STOCK.har`            | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-DELETE-SPECIES-STOCK-SHOT    | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-DELETE-SPECIES-STOCK.png`    | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-ADD-VENUE-PHOTO-HAR          | HAR                 | Normal  | Call `admin_add_venue_photo` as non-admin                                                                                             | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-ADD-VENUE-PHOTO.har`                 | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-ADD-VENUE-PHOTO-SHOT         | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-ADD-VENUE-PHOTO.png`         | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-DELETE-VENUE-PHOTO-HAR       | HAR                 | Normal  | Call `admin_delete_venue_photo` as non-admin                                                                                          | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-DELETE-VENUE-PHOTO.har`              | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-DELETE-VENUE-PHOTO-SHOT      | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-DELETE-VENUE-PHOTO.png`      | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-RPC-NONADMIN-DENY-SET-VENUE-PHOTO-PRIMARY-HAR  | HAR                 | Normal  | Call `admin_set_venue_photo_primary` as non-admin                                                                                     | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/har/AVD-RPC-NONADMIN-DENY-SET-VENUE-PHOTO-PRIMARY.har`         | Expect admin-only error.                                                                                                                                                                                                                                                                                                                                                                                                       |
| AVD-RPC-NONADMIN-DENY-SET-VENUE-PHOTO-PRIMARY-SHOT | Shot                | Normal  | RPC error surfaced                                                                                                                    | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/screenshots/AVD-RPC-NONADMIN-DENY-SET-VENUE-PHOTO-PRIMARY.png` | Capture error text.                                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-SQL-GRANTS                                     | SQL                 | Admin   | Grants on touched tables/views                                                                                                        | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/sql/AVD-GRANTS.sql`                                            | Include `admin_users`, `venues`, `venue_stats`, `venue_owners`, `profiles`, `venue_events`, `venue_rules`, `venue_opening_hours`, `venue_pricing_tiers`, `venue_species_stock`, `venue_photos`.                                                                                                                                                                                                                                |
| AVD-SQL-RLS-POLICIES                               | SQL                 | Admin   | RLS policies for touched tables                                                                                                       | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/sql/AVD-RLS-POLICIES.sql`                                      | Capture policy names + expressions.                                                                                                                                                                                                                                                                                                                                                                                            |
| AVD-SQL-RPC-GRANTS                                 | SQL                 | Admin   | RPC definitions + EXECUTE grants + proconfig                                                                                          | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/sql/AVD-RPC-GRANTS.sql`                                        | Include all admin RPCs used by this surface + `get_venue_photos`.                                                                                                                                                                                                                                                                                                                                                              |
| AVD-SQL-NONADMIN-SELECT                            | SQL                 | Normal  | Direct SELECT probes as non-admin                                                                                                     | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/sql/AVD-NONADMIN-SELECT.sql`                                   | Probe `admin_users`, `venues`, `venue_stats`, `venue_owners`, `profiles`, `venue_events`, `venue_rules`, `venue_opening_hours`, `venue_pricing_tiers`, `venue_species_stock`, `venue_photos`.                                                                                                                                                                                                                                  |
| AVD-SQL-STORAGE-POLICIES                           | SQL                 | Admin   | Storage policy posture for venue photos                                                                                               | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/sql/AVD-STORAGE-POLICIES.sql`                                  | Use `pg_policy` + `pg_get_expr` to capture policy intent; include a bucket_id spot-check for `venue-photos`.                                                                                                                                                                                                                                                                                                                   |
| AVD-SQL-VIEW-POSTURE                               | SQL                 | Admin   | View posture for `venue_stats`                                                                                                        | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/sql/AVD-VIEW-POSTURE.sql`                                      | Capture relowner + reloptions (security_invoker).                                                                                                                                                                                                                                                                                                                                                                              |

| AVD-SQL-GRANTS | SQL | Admin | Grants on tables/views used by this surface | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/sql/AVD-SQL-GRANTS.sql` | Include: admin*users, venues, venue_stats, venue_owners, profiles, venue_events, venue_rules, venue_opening_hours, venue_pricing_tiers, venue_species_stock, venue_photos. |
| AVD-SQL-RLS-POLICIES | SQL | Admin | RLS policies for tables used by this surface | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/sql/AVD-SQL-RLS-POLICIES.sql` | Capture pg_policies output for the same set; verify admin-only vs owner-only policies match contract. |
| AVD-SQL-RPC-POSTURE | SQL | Admin | RPC definitions + EXECUTE grants + SECURITY DEFINER/search_path posture | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/sql/AVD-SQL-RPC-POSTURE.sql` | For: admin_get_venue_by_slug, admin_get_venue_events, admin_update_venue_metadata, admin_update_venue_booking, admin*\* owners/events/rules/opening_hours/pricing/species_stock/photos, and get_venue_photos. |
| AVD-SQL-VIEW-SECURITY | SQL | Admin | Verify `venue_stats` view ownership and security posture (invoker/definer) | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/sql/AVD-SQL-VIEW-SECURITY.sql` | Confirm `venue_stats` owner, `security_invoker` setting (if applicable), and whether any sensitive columns could leak via the view. |
| AVD-SQL-STORAGE-POLICIES | SQL | Admin | Storage policies for `venue-photos` bucket | `docs/version5/hardening/surfaces/admin-venues-detail/evidence/sql/AVD-SQL-STORAGE-POLICIES.sql` | Use `pg_policy` + `pg_get_expr(...)` inspection and include a bucket_id spot check on storage.objects. |
