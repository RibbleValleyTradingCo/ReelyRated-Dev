# Evidence Index

| Evidence ID                     | Type (HAR/SQL/Shot) | Persona | Scenario                                                                      | File path                                                                                           | Notes                                                                                                                                                                                                                                                              |
| ------------------------------- | ------------------- | ------- | ----------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| AV-ANON-ROUTE-DENY-HAR          | HAR                 | Anon    | Visit `/admin/venues` and confirm redirect to `/auth`                         | `docs/version5/hardening/surfaces/admin-venues/evidence/har/AV-ANON-ROUTE-DENY.har`                 | Capture 302/redirect chain.                                                                                                                                                                                                                                        |
| AV-ANON-ROUTE-DENY-SHOT         | Shot                | Anon    | Auth redirect screen                                                          | `docs/version5/hardening/surfaces/admin-venues/evidence/screenshots/AV-ANON-ROUTE-DENY.png`         | Include URL bar.                                                                                                                                                                                                                                                   |
| AV-NORMAL-DENY-HAR              | HAR                 | Normal  | Authenticated non-admin blocked from admin venues                             | `docs/version5/hardening/surfaces/admin-venues/evidence/har/AV-NORMAL-DENY.har`                     | Expect toast + navigate to `/`.                                                                                                                                                                                                                                    |
| AV-NORMAL-DENY-SHOT             | Shot                | Normal  | Post-redirect screen + toast                                                  | `docs/version5/hardening/surfaces/admin-venues/evidence/screenshots/AV-NORMAL-DENY.png`             | Capture toast text.                                                                                                                                                                                                                                                |
| AV-OWNER-DENY-HAR               | HAR                 | Owner   | Owner blocked from admin venues                                               | `docs/version5/hardening/surfaces/admin-venues/evidence/har/AV-OWNER-DENY.har`                      | Expect toast + navigate to `/`.                                                                                                                                                                                                                                    |
| AV-OWNER-DENY-SHOT              | Shot                | Owner   | Post-redirect screen + toast                                                  | `docs/version5/hardening/surfaces/admin-venues/evidence/screenshots/AV-OWNER-DENY.png`              | Capture toast text.                                                                                                                                                                                                                                                |
| AV-PRIVATE-DENY-HAR             | HAR                 | Private | Private persona blocked from admin venues                                     | `docs/version5/hardening/surfaces/admin-venues/evidence/har/AV-PRIVATE-DENY.har`                    | Expect toast + navigate to `/`.                                                                                                                                                                                                                                    |
| AV-PRIVATE-DENY-SHOT            | Shot                | Private | Post-redirect screen + toast                                                  | `docs/version5/hardening/surfaces/admin-venues/evidence/screenshots/AV-PRIVATE-DENY.png`            | Capture toast text.                                                                                                                                                                                                                                                |
| AV-BLOCKED-DENY-HAR             | HAR                 | Blocked | Blocked persona blocked from admin venues                                     | `docs/version5/hardening/surfaces/admin-venues/evidence/har/AV-BLOCKED-DENY.har`                    | Expect toast + navigate to `/`.                                                                                                                                                                                                                                    |
| AV-BLOCKED-DENY-SHOT            | Shot                | Blocked | Post-redirect screen + toast                                                  | `docs/version5/hardening/surfaces/admin-venues/evidence/screenshots/AV-BLOCKED-DENY.png`            | Capture toast text.                                                                                                                                                                                                                                                |
| AV-ADMIN-ALLOW-HAR              | HAR                 | Admin   | Admin loads venues list                                                       | `docs/version5/hardening/surfaces/admin-venues/evidence/har/AV-ADMIN-ALLOW.har`                     | Ensure only expected calls: `POST /rest/v1/rpc/admin_get_venues` (limit 20 + offset paging) and admin gate read (`/rest/v1/admin_users`) if present. No direct reads of sensitive columns outside the RPC.                                                         |
| AV-ADMIN-ALLOW-SHOT             | Shot                | Admin   | Venues list loaded                                                            | `docs/version5/hardening/surfaces/admin-venues/evidence/screenshots/AV-ADMIN-ALLOW.png`             | Show search + list.                                                                                                                                                                                                                                                |
| AV-RPC-NONADMIN-DENY-HAR        | HAR                 | Normal  | Call `admin_get_venues` as non-admin                                          | `docs/version5/hardening/surfaces/admin-venues/evidence/har/AV-RPC-NONADMIN-DENY.har`               | Expect error "Admin privileges required". Probe endpoint: `POST /rest/v1/rpc/admin_get_venues` with body `{"p_search":null,"p_limit":1,"p_offset":0}`.                                                                                                             |
| AV-RPC-NONADMIN-DENY-SHOT       | Shot                | Normal  | RPC error surfaced in UI/console                                              | `docs/version5/hardening/surfaces/admin-venues/evidence/screenshots/AV-RPC-NONADMIN-DENY.png`       | Capture error text.                                                                                                                                                                                                                                                |
| AV-POSTGREST-NONADMIN-DENY-HAR  | HAR                 | Normal  | Direct PostgREST reads of `admin_users`, `venues`, `venue_stats` as non-admin | `docs/version5/hardening/surfaces/admin-venues/evidence/har/AV-POSTGREST-NONADMIN-DENY.har`         | Hit endpoints as non-admin (expect deny or 0 rows):<br>- `GET /rest/v1/admin_users?select=*`<br>- `GET /rest/v1/venues?select=*&limit=1`<br>- `GET /rest/v1/venue_stats?select=*&limit=1`<br>If rows return, capture status + response payload and document scope. |
| AV-POSTGREST-NONADMIN-DENY-SHOT | Shot                | Normal  | PostgREST error/response captured                                             | `docs/version5/hardening/surfaces/admin-venues/evidence/screenshots/AV-POSTGREST-NONADMIN-DENY.png` | Capture the response payload + status for each endpoint attempted (include request URL in the screenshot if possible).                                                                                                                                             |
| AV-SQL-GRANTS                   | SQL                 | Admin   | Grants on touched tables/views                                                | `docs/version5/hardening/surfaces/admin-venues/evidence/sql/AV-GRANTS.sql`                          | `admin_users, venues, venue_stats`.                                                                                                                                                                                                                                |
| AV-SQL-RLS-POLICIES             | SQL                 | Admin   | RLS policies for touched tables                                               | `docs/version5/hardening/surfaces/admin-venues/evidence/sql/AV-RLS-POLICIES.sql`                    | Include `venues_select_admin_all`, `venues_select_published`, `admin_users_self_select`.                                                                                                                                                                           |
| AV-SQL-RPC-GRANTS               | SQL                 | Admin   | RPC definition + EXECUTE grants + search_path                                 | `docs/version5/hardening/surfaces/admin-venues/evidence/sql/AV-RPC-GRANTS.sql`                      | `admin_get_venues` (SECURITY INVOKER).                                                                                                                                                                                                                             |
| AV-SQL-NONADMIN-DIRECT-SELECT   | SQL                 | Normal  | Direct SELECT probes for sensitive tables/views                               | `docs/version5/hardening/surfaces/admin-venues/evidence/sql/AV-NONADMIN-SELECT.sql`                 | Probe `admin_users`, `venues`, `venue_stats`; confirm RLS/privileges.                                                                                                                                                                                              |
